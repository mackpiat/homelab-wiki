{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"T470 Edge Router Infrastructure","text":"<p>Welcome to the internal documentation wiki for the homelab edge environment.</p>"},{"location":"#overview","title":"Overview","text":"<p>This system serves as the primary gateway, DNS resolver, and active defense node for the network. It is built on a \"trust no one\" architecture.</p>"},{"location":"#core-services","title":"Core Services","text":"<ul> <li>Hardware: Lenovo ThinkPad T470 (Utilizing battery as built-in UPS)</li> <li>OS: Debian Linux</li> <li>Perimeter Defense: CrowdSec IDS/IPS (nftables bouncer)</li> <li>DNS Resolution: Unbound (Recursive caching) + AdGuard Home</li> <li>Overlay Network: Tailscale</li> </ul> <p>Documentation maintained via automated CI/CD pipeline.</p>"},{"location":"crowdsec/","title":"CrowdSec IDS/IPS Deployment","text":""},{"location":"crowdsec/#overview","title":"Overview","text":"<p>This document outlines the deployment and configuration of CrowdSec on the Debian router. CrowdSec acts as a collaborative Intrusion Detection System (IDS) and Intrusion Prevention System (IPS). It parses local system logs in real-time, cross-references suspicious behavior against a global threat intelligence network, and actively drops malicious packets at the network edge.</p>"},{"location":"crowdsec/#architecture","title":"Architecture","text":"<ul> <li>Core Engine - <code>crowdsec</code> (Responsible for log acquisition and parsing)</li> <li>Mitigation Bouncer - <code>crowdsec-firewall-bouncer-nftables</code> (Responsible for manipulating firewall rules)</li> <li>Telemetry - <code>cscli</code> (Command Line Interface for engine management)</li> </ul>"},{"location":"crowdsec/#1-installation","title":"1. Installation","text":"<p>The deployment requires two distinct components - the monitoring agent and the enforcement bouncer.</p> <ul> <li>Add the official CrowdSec repository to receive timely security patches directly from the maintainers, bypassing older Debian repos.</li> </ul> <pre><code>curl -s [https://install.crowdsec.net](https://install.crowdsec.net) | sudo bash\n</code></pre> <ul> <li>Install the core engine. By default, it runs as a daemon but does not actively block traffic yet.</li> </ul> <pre><code>sudo apt install crowdsec -y\n</code></pre> <ul> <li>Install the specific bouncer for our firewall backend. This binary reads the local API decisions from the CrowdSec engine and automatically creates 'drop' rules in the nftables chains.</li> </ul> <pre><code>sudo apt install crowdsec-firewall-bouncer-nftables -y\n</code></pre>"},{"location":"crowdsec/#2-threat-intelligence-sync","title":"2. Threat Intelligence Sync","text":"<ul> <li>To ensure the router defends against zero-day threats and currently active botnets, the local hub must be synchronized with the global database.</li> <li>'hub update' pulls the latest index of available parsers and global blocklists.</li> <li>'hub upgrade' applies them to the local engine, immediately shielding the router from tens of thousands of globally recognized malicious IPs.</li> </ul> <pre><code>sudo cscli hub update &amp;&amp; sudo cscli hub upgrade\n</code></pre>"},{"location":"crowdsec/#3-log-acquisition-parsing-the-systemd-fix","title":"3. Log Acquisition &amp; Parsing (The systemd Fix)","text":"<p>By default, modern Debian systems utilize journald for logging, rather than flat files in /var/log/. The engine required specific parsers to translate the systemd journal format into actionable threat intelligence.</p> <ul> <li>Install the baseline Linux collection, providing the dictionaries necessary to understand syslog and iptables/nftables drop logs.</li> </ul> <pre><code>sudo cscli collections install crowdsecurity/linux\n</code></pre> <ul> <li>Install the specific dictionaries required to parse OpenSSH daemon logs, allowing the engine to detect SSH brute-force and exploit attempts.</li> </ul> <pre><code>sudo cscli collections install crowdsecurity/sshd\n</code></pre> <p>Baseline Linux and sshd collection comes along with the package (Optional to run the above commands, incase the collections are not installed).</p> <ul> <li>The CrowdSec daemon loads parsers into memory at boot. Restarting the service forces it to apply the newly installed collections to the live journal stream.</li> </ul> <pre><code>sudo systemctl restart crowdsec\n</code></pre>"},{"location":"crowdsec/#4-operational-verification","title":"4. Operational Verification","text":"<ul> <li>View all IPs currently banned by the local firewall</li> </ul> <pre><code>sudo cscli decisions list\n</code></pre> <ul> <li>View the status of log parsing and acquisition (Verify 'Lines parsed' increments under Acquisition Metrics)</li> </ul> <pre><code>sudo cscli metrics\n</code></pre> <ul> <li>Tail the live CrowdSec engine logs via the systemd journal</li> </ul> <pre><code>sudo journalctl -u crowdsec -f\n</code></pre>"}]}